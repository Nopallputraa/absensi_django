{% extends "base.html" %}
{% block content %}
<div class="flex justify-between items-center mb-4">
  <h1 class="text-2xl font-semibold">Daftar Absensi</h1>
  <a href="{% url 'employees:attendance-add' %}" class="px-3 py-1 bg-indigo-600 text-white rounded">Tambah Absensi</a>
</div>

<form method="get" class="mb-4 flex gap-2">
  <input name="q" placeholder="Cari nama atau NIK" class="p-2 border rounded" value="{{ request.GET.q }}">
  <input type="date" name="date" class="p-2 border rounded" value="{{ request.GET.date }}">
  <button class="px-3 py-1 bg-gray-200 rounded">Filter</button>
</form>

<table class="w-full bg-white shadow rounded">
  <thead class="border-b">
    <tr><th class="p-2">Nama</th><th class="p-2">Tipe</th><th class="p-2">Waktu</th><th class="p-2">Catatan</th></tr>
  </thead>
  <tbody>
    {% for a in attendances %}
      <tr class="border-b">
        <td class="p-2">{{ a.employee.name }} ({{ a.employee.nik }})</td>
        <td class="p-2">{{ a.get_check_type_display }}</td>
        <td class="p-2">{{ a.timestamp|date:"Y-m-d H:i" }}</td>
        <td class="p-2">{{ a.note }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="4" class="p-4 text-center">Tidak ada data absensi.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% if is_paginated %}
  <div class="mt-4">
    {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">Prev</a>{% endif %}
    Page {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
    {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Next</a>{% endif %}
  </div>
{% endif %}

<!-- Quick check-in: contoh form sederhana -->
<div class="mt-6 bg-white p-4 rounded shadow">
  <h2 class="font-semibold mb-2">Quick Check (Check-in / Check-out)</h2>
  <form method="post" action="{% url 'employees:attendance-quick-check' %}" class="flex gap-2 items-center">
    {% csrf_token %}
    <select name="employee_id" class="p-2 border rounded">
      {% for e in employees %}
        <option value="{{ e.pk }}">{{ e.name }} ({{ e.nik }})</option>
      {% endfor %}
    </select>
    <select name="check_type" class="p-2 border rounded">
      <option value="IN">Check-in</option>
      <option value="OUT">Check-out</option>
    </select>
    <button class="px-3 py-1 bg-green-600 text-white rounded">Submit</button>
  </form>
</div>

{% endblock %}